apply plugin: "org.sonarqube"
apply plugin: 'jacoco-android'
apply plugin: 'jacoco'
apply plugin: 'codenarc'
apply plugin: 'ru.vyarus.java-lib'

jacoco {
    toolVersion = "0.7.5.201505241946"
}

sonarqube {
    androidVariant 'debug'
    properties {
      property "sonar.links.homepage", "https://github.com/gregswindle/cookiemaster-android-lib"
      property "sonar.links.ci",       "https://travis-ci.org/gregswindle/cookiemaster-android-lib"
      property "sonar.links.issue",    "https://github.com/gregswindle/cookiemaster-android-lib/issues"
      property "sonar.links.scm",      "https://github.com/gregswindle/cookiemaster-android-lib"

      property "sonar.host.url",    "https://sonarqube.com"
      property "sonar.language",    "java"
      property "sonar.projectName", "cookiemaster-android-lib"
      property "sonar.projectDescription", "Native Android .aar extraction from com.cordova.plugins.cookiemaster.CookieMaster for reuse in native Android as well as Cordova using the Android Studio Library directory structure."
      property "sonar.projectKey",  "gregswindle-cookiemaster-android-lib"
      property "sonar.projectVersion",  "0.1.0"

      property "sonar.sourceEncoding", "UTF-8"
      property "sonar.sources",        "src/main/java"
      property "sonar.exclusions",     "build/**,**/*.png"

// @see: https://docs.sonarqube.org/display/PLUG/GitHub+Plugin
      property "sonar.github.oath",   System.getenv("SONARQUBE_QA_GATEWAY")
      property "sonar.analysis.mode", "issues"
      property "sonar.login", System.getenv("SONAR_TOKEN")
      property "sonar.github.repository", "gregswindle/cookiemaster-android-lib"
      //property "sonar.github.pullRequest", System.getenv("PULL_REQUEST_ID")

      property "sonar.android.lint.report", "build/reports/lint-results.xml"
      property "sonar.junit.reportsPath",   "build/test-results/testDebugUnitTest"
      property "sonar.jacoco.reportPaths",  "build/jacoco/testDebugUnitTest.exec"
    }
}

jacocoAndroidUnitTestReport {
    csv.enabled false
    html.enabled true
    xml.enabled true
}
